--------------------------------------------------------------------------------
-- in
--------------------------------------------------------------------------------
select empno, ename
from emp
where deptno in (30);

--------------------------------------------------------------------------------
-- in (�ȵ�)
--------------------------------------------------------------------------------
select empno, ename
from emp e 
where deptno in (select deptno from dept);

--------------------------------------------------------------------------------
-- join
--------------------------------------------------------------------------------
select e.empno, e.ename, d.dname
from emp e join dept d on (e.deptno = d.deptno)
where d.deptno = 30;

--------------------------------------------------------------------------------
-- left semi join
--------------------------------------------------------------------------------
select e.empno, e.ename
from emp e 
left semi join dept d on (e.deptno = d.deptno)
where e.deptno = 30;

--------------------------------------------------------------------------------
-- anti join
--------------------------------------------------------------------------------
select e.empno, e.ename
from emp e 
anti join dept d on (e.deptno = d.deptno)
where e.deptno = 30;

--------------------------------------------------------------------------------
-- outer join
--------------------------------------------------------------------------------
select d.deptno, d.dname, e.empno, e.ename
from dept d full outer join emp e on (d.deptno = e.deptno)
where d.deptno > 20;
--and d.deptno < nvl(e.sal, 9999);


--------------------------------------------------------------------------------
-- multi table insert
--------------------------------------------------------------------------------
from dept
insert overwrite table dept2
select *    
insert overwrite table dept3
select *;


--------------------------------------------------------------------------------
-- group by
--------------------------------------------------------------------------------
select deptno, count(1)
from emp
where deptno > 0
group by deptno;

--------------------------------------------------------------------------------
-- distributed by
--------------------------------------------------------------------------------
select deptno, empno, ename, sal
from emp
distribute by deptno sort by deptno, sal, empno asc;

--------------------------------------------------------------------------------
-- nvl, coalesce
--------------------------------------------------------------------------------
select empno, coalesce(ename, '?') 
from emp;  

--------------------------------------------------------------------------------
-- decode, case
--------------------------------------------------------------------------------
select empno, ename, 
       case sal 
       when 100 then 'A' 
       when 110 then 'B' 
       else 'C' 
       end
from emp;


--------------------------------------------------------------------------------
-- subquery
--------------------------------------------------------------------------------


--------------------------------------------------------------------------------
-- union
--------------------------------------------------------------------------------


--------------------------------------------------------------------------------
-- udaf - maximum()
--------------------------------------------------------------------------------
select deptno, maximum(sal)
from emp
group by deptno;

--------------------------------------------------------------------------------
-- udf - row_number()
--------------------------------------------------------------------------------
select deptno, empno, ename, sal, rank(ename), row_number(deptno)
from (
    select deptno, empno, ename, sal
    from emp
    where deptno > 0
    distribute by deptno sort by deptno, sal desc) A;



select deptno, empno, sal, row_number(deptno)
from (
    select deptno, empno, ename, sal
    from emp
    where deptno > 0
    distribute by deptno sort by deptno, sal desc) A;


